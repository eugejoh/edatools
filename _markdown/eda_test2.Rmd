---
author: "Eugene Joh"
date: "`r format(Sys.Date(), '%A, %B %d, %Y')`"
output: 
  html_document:
    code_folding: hide
    theme: simplex
    highlight: tango
    df_print: kable
    css: toc_css.css
    toc: yes
    toc_depth: 3
params:
  set_title: "Data Profile: blank" #Title "EDA: ..." followed by dataframe name
  data: NULL #actual list `my_list`
  name_i: "first list object" #name of each list `names(my_list)`
  continuous: TRUE #logical to include continuous variables
  categorical: TRUE #logical to include categorical variables
title: "`r params$set_title`"
---

<!-- The input for this parameterized R markdown file is a named `list` of `data.frames` -->
<!-- The parameters above specify the title used (dependent on each named object in `list`), number of `data.frames` in the list, names of the `data.frames`, logical for whether you want to include continuous and/or categorical variables. -->


```{r setup, include=FALSE}
bt <- proc.time()
if (!require(here)) install.packages("here")
# setup knitr chunks
knitr::opts_chunk$set(echo = TRUE, fig.width = 9.2, message = FALSE, warning = FALSE)

# load functions from "R" folder
if (any(grepl("R", list.files(here::here())))) invisible(lapply(list.files(here::here("R"), full.names = TRUE), source))

# # scale for fig height
# nvar <- length(names(params$data))
# fig.h <- nvar*0.8
```

```{r load_packages, echo=FALSE, include=FALSE}
packs <- c("haven","dplyr","tidyr","purrr","data.table","forcats","stringr", #process
           "ggplot2","scales","ggfortify","grid","gridExtra", #data viz
           "knitr","kableExtra","DT","htmlwidgets") #html widgets
install_packs(packs); rm(packs)
```

```{r first_test, include=FALSE, eval=TRUE}
cont_log <- params$continuous
ca_log <- params$categorical
```

```{r figscale, include=FALSE}
# scale for fig height
nvar <- length(names(params$data))
fig.h <- nvar*0.8
```

# Overview 
This parameterized markdown file is a standarized exploratory analysis report, examining the data type, structure, missing values, unique values, summary statistics for continuous and categorical variables contained within a `data.frame` object.   

This does not support `date-time` varaibles such as `POSIXct` or `Date`, but will eventually move to support all data types typically found in `data.frame` in the R environment.  

# Data Structure
The input file **`r params$name_i`** is a `r class(params$data)`. It contains `r nrow(params$data)` rows and `r ncol(params$data)` columns. The table below summarizes the data structure of the object. The column names are displayed in the code chunk below.  

<!-- Continuous Variables -->
```{r cont_log, include = FALSE}
if (length(names(dplyr::select_if(params$data, funs(is.numeric(.))))) < 1) {
  cont_log <- FALSE #set condition for creating following code chunks
}
```

`r if(cont_log) {"# Continuous Variables"}`
```{r cont_vars-md, include=FALSE, message=FALSE}
out_cont <- NULL
for (j in names(dplyr::select_if(params$data, funs(is.numeric(.))))) { #based on the names that are numeric
  out_cont <- c(out_cont, knitr::knit_expand('cont_var2.Rmd')) #apply child .Rmd to select variables
}
```
`r if(cont_log) paste(knit(text=out_cont), collapse = '\n')`

<!-- Categorical Variables -->
```{r ca_log, include = FALSE}
if (length(names(dplyr::select_if(params$data, funs(is.character(.) | is.factor(.))))) < 1) {
  ca_log <- FALSE
}
```

`r if(ca_log) {"# Categorical Variables"}`
```{r cat_vars-md, include=FALSE, message=FALSE}
out_catgorical <- NULL
for (k in names(dplyr::select_if(params$data, funs(is.character(.) | is.factor(.)) ))) {
  out_catgorical <- c(out_catgorical, knitr::knit_expand('cat_var2.Rmd'))
}
```
`r if(ca_log) paste(knit(text=out_catgorical), collapse = '\n')`


<br>

# R Session Info
```{r session_info, echo = FALSE}
sessionInfo()
```

<br>
<br>
Process Time: `r round((proc.time()["elapsed"] - bt["elapsed"])/60, 1)` minutes  
`r version$version.string`  

